YUI.add("calendar",function(e,t){var a=e.ClassNameManager.getClassName,i="calendar",o=(a(i,"header"),a(i,"day-selected")),s=a(i,"day-highlighted"),h=a(i,"day"),l=a(i,"prevmonth-day"),n=a(i,"nextmonth-day"),d=a(i,"grid"),c=e.DataType.Date,r=(e.delegate,a(i,"pane")),u=e.UA.os;e.Calendar=e.extend(function _(e){_.superclass.constructor.apply(this,arguments)},e.CalendarBase,{_keyEvents:[],_highlightedDateNode:null,_lastSelectedDate:null,initializer:function(){this.plug(e.Plugin.CalendarNavigator),this._keyEvents=[],this._highlightedDateNode=null,this._lastSelectedDate=null},_bindCalendarEvents:function(){var e=this.get("contentBox").one("."+r);e.on("selectstart",this._preventSelectionStart),e.delegate("click",this._clickCalendar,"."+h+", ."+l+", ."+n,this),e.delegate("keydown",this._keydownCalendar,"."+d,this),e.delegate("focus",this._focusCalendarGrid,"."+d,this),e.delegate("focus",this._focusCalendarCell,"."+h,this),e.delegate("blur",this._blurCalendarGrid,"."+d+",."+h,this)},_preventSelectionStart:function(e){e.preventDefault()},_highlightDateNode:function(e){this._unhighlightCurrentDateNode();var t=this._dateToNode(e);t.focus(),t.addClass(s)},_unhighlightCurrentDateNode:function(){var e=this.get("contentBox").all("."+s);e&&e.removeClass(s)},_getGridNumber:function(e){var t=e.get("id").split("_").reverse();return parseInt(t[0],10)},_blurCalendarGrid:function(e){this._unhighlightCurrentDateNode()},_focusCalendarCell:function(e){this._highlightedDateNode=e.target,e.stopPropagation()},_focusCalendarGrid:function(e){this._unhighlightCurrentDateNode(),this._highlightedDateNode=null},_keydownCalendar:function(e){var t,a,i,s,h,l=this._getGridNumber(e.target),n=this._highlightedDateNode?this._nodeToDate(this._highlightedDateNode):null,d=e.keyCode,r=0;switch(d){case 40:r=7,"s";break;case 38:r=-7,"n";break;case 37:r=-1,"w";break;case 39:r=1,"e";break;case 32:case 13:e.preventDefault(),this._highlightedDateNode&&("single"!==(t=this.get("selectionMode"))||this._highlightedDateNode.hasClass(o)?"multiple"!==t&&"multiple-sticky"!==t||(this._highlightedDateNode.hasClass(o)?this._removeDateFromSelection(n):this._addDateToSelection(n)):(this._clearSelection(!0),this._addDateToSelection(n)))}40!=d&&38!=d&&37!=d&&39!=d||(n||(n=c.addMonths(this.get("date"),l),r=0),e.preventDefault(),a=c.addDays(n,r),i=this.get("date"),s=c.addMonths(this.get("date"),this._paneNumber-1),h=new Date(s),s.setDate(c.daysInMonth(s)),c.isInRange(a,i,s)?this._highlightDateNode(a):c.isGreater(i,a)?c.isGreaterOrEqual(this.get("minimumDate"),i)||(this.set("date",c.addMonths(i,-1)),this._highlightDateNode(a)):c.isGreater(a,s)&&(c.isGreaterOrEqual(h,this.get("maximumDate"))||(this.set("date",c.addMonths(i,1)),this._highlightDateNode(a))))},_clickCalendar:function(e){var t,a=e.currentTarget,i=a.hasClass(h)&&!a.hasClass(l)&&!a.hasClass(n),s=a.hasClass(o);switch(this.get("selectionMode")){case"single":i&&(s||(this._clearSelection(!0),this._addDateToSelection(this._nodeToDate(a))));break;case"multiple-sticky":i&&(s?this._removeDateFromSelection(this._nodeToDate(a)):this._addDateToSelection(this._nodeToDate(a)));break;case"multiple":i&&(e.metaKey||e.ctrlKey||e.shiftKey?("macintosh"==u&&e.metaKey||"macintosh"!=u&&e.ctrlKey)&&!e.shiftKey?s?(this._removeDateFromSelection(this._nodeToDate(a)),this._lastSelectedDate=null):(this._lastSelectedDate=this._nodeToDate(a),this._addDateToSelection(this._lastSelectedDate)):("macintosh"==u&&e.metaKey||"macintosh"!=u&&e.ctrlKey)&&e.shiftKey?this._lastSelectedDate?(t=this._nodeToDate(a),this._addDateRangeToSelection(t,this._lastSelectedDate),this._lastSelectedDate=t):(this._lastSelectedDate=this._nodeToDate(a),this._addDateToSelection(this._lastSelectedDate)):e.shiftKey&&(this._lastSelectedDate?(t=this._nodeToDate(a),this._clearSelection(!0),this._addDateRangeToSelection(t,this._lastSelectedDate),this._lastSelectedDate=t):(this._clearSelection(!0),this._lastSelectedDate=this._nodeToDate(a),this._addDateToSelection(this._lastSelectedDate))):(this._clearSelection(!0),this._lastSelectedDate=this._nodeToDate(a),this._addDateToSelection(this._lastSelectedDate)))}i?this.fire("dateClick",{cell:a,date:this._nodeToDate(a)}):a.hasClass(l)?this.fire("prevMonthClick"):a.hasClass(n)&&this.fire("nextMonthClick")},subtractMonth:function(e){this.set("date",c.addMonths(this.get("date"),-1)),e&&e.halt()},subtractYear:function(e){this.set("date",c.addYears(this.get("date"),-1)),e&&e.halt()},addMonth:function(e){this.set("date",c.addMonths(this.get("date"),1)),e&&e.halt()},addYear:function(e){this.set("date",c.addYears(this.get("date"),1)),e&&e.halt()}},{NAME:"calendar",ATTRS:{selectionMode:{value:"single"},date:{value:new Date,lazyAdd:!1,setter:function(e){var t=this._normalizeDate(e),a=c.addMonths(t,this._paneNumber-1),i=this.get("minimumDate"),s=this.get("maximumDate");return i&&!c.isGreaterOrEqual(t,i)||s&&!c.isGreaterOrEqual(s,a)?i&&c.isGreater(i,t)?i:s&&c.isGreater(a,s)?c.addMonths(s,-1*(this._paneNumber-1)):void 0:t}},minimumDate:{value:null,setter:function(e){if(e){var t=this.get("date"),a=this._normalizeDate(e);return t&&!c.isGreaterOrEqual(t,a)&&this.set("date",a),a}return this._normalizeDate(e)}},maximumDate:{value:null,setter:function(e){if(e){var t=this.get("date"),a=this._normalizeDate(e);return t&&!c.isGreaterOrEqual(e,c.addMonths(t,this._paneNumber-1))&&this.set("date",c.addMonths(a,-1*(this._paneNumber-1))),a}return e}}}})},"@VERSION@",{requires:["calendar-base","calendarnavigator"],lang:["de","en","fr","ja","nb-NO","pt-BR","ru","zh-HANT-TW"],skinnable:!0});